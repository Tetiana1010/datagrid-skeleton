var v,x,k,w;if(typeof naja<"u")v=function(i,a){var l=a.init,d=a.success,t=a.before,e=a.complete,n=a.interaction,s=function(o,h){return this.name=h,l&&o.addEventListener("init",function(c){l(c.defaultOptions)}),d&&o.addEventListener("success",function(c){d(c.response,c.options)}),o.addEventListener("interaction",function(c){c.options.nette={el:$(c.element)},n&&(n(c.options)||c.preventDefault())}),t&&o.addEventListener("before",function(c){t(c.xhr,c.options)||c.preventDefault()}),e&&o.addEventListener("complete",function(c){e(c.xhr,c.options)}),this};naja.registerExtension(s,i)},x=function(i){var a=i.type||"GET",l=i.data||null;naja.makeRequest(a,i.url,l,{}).then(i.success).catch(i.error)},k=function(){naja.load()},w=function(i){return naja.uiHandler.submitForm(i.get(0))};else if($.nette)v=function(i,a){$.nette.ext(i,a)},x=function(i){$.nette.ajax(i)},k=function(){$.nette.load()},w=function(i){return i.submit()};else throw new Error("Include Naja.js or nette.ajax for datagrids to work!");var D,T,A,N,P,S,H=[].indexOf||function(i){for(var a=0,l=this.length;a<l;a++)if(a in this&&this[a]===i)return a;return-1};$(document).on("click","[data-datagrid-confirm]:not(.ajax)",function(i){if(!confirm($(i.target).closest("a").attr("data-datagrid-confirm")))return i.stopPropagation(),i.preventDefault()});typeof naja<"u"?v("datagrid.confirm",{interaction:function(i){var a;return i.nette&&(a=i.nette.el.data("datagrid-confirm"),a)?confirm(a):!0}}):v("datagrid.confirm",{before:function(i,a){var l;return a.nette&&(l=a.nette.el.data("datagrid-confirm"),l)?confirm(l):!0}});$(document).on("change","select[data-autosubmit-per-page]",function(){var i;return i=$(this).parent().find("input[type=submit]"),i.length===0&&(i=$(this).parent().find("button[type=submit]")),i.click()}).on("change","select[data-autosubmit]",function(){return w($(this).closest("form").first())}).on("change","input[data-autosubmit][data-autosubmit-change]",function(i){var a;return i.which||i.keyCode,clearTimeout(window.datagrid_autosubmit_timer),a=$(this),window.datagrid_autosubmit_timer=setTimeout(function(l){return function(){return w(a.closest("form").first())}}(),200)}).on("keyup","input[data-autosubmit]",function(i){var a,l;if(l=i.which||i.keyCode||0,!(l!==13&&(l>=9&&l<=40||l>=112&&l<=123)))return clearTimeout(window.datagrid_autosubmit_timer),a=$(this),window.datagrid_autosubmit_timer=setTimeout(function(d){return function(){return w(a.closest("form").first())}}(),200)}).on("keydown",".datagrid-inline-edit input",function(i){var a;if(a=i.which||i.keyCode||0,a===13)return i.stopPropagation(),i.preventDefault(),$(this).closest("tr").find('.col-action-inline-edit [name="inline_edit[submit]"]').click()});$(document).on("keydown","input[data-datagrid-manualsubmit]",function(i){var a;if(a=i.which||i.keyCode||0,a===13)return i.stopPropagation(),i.preventDefault(),w($(this).closest("form").first())});S=function(i){var a,l;if(H.call(i,l)>=0)return i.path;for(l=[],a=i.target;a!==document.body&&a!==null;)l.push(a),a=a.parentNode;return l};A=function(){var i;return i=null,document.addEventListener("click",function(a){var l,d,t,e,n,s,r,o,h,c,u,f,p,m,g,_,b,C,y;for(g=S(a),n=0,f=g.length;n<f;n++)if(t=g[n],$(t).is(".col-checkbox")&&i&&a.shiftKey){if(d=$(t).closest("tr"),c=i.closest("tr"),u=c.closest("tbody"),l=u.find("tr").toArray(),d.index()>c.index()?y=l.slice(c.index(),d.index()):d.index()<c.index()&&(y=l.slice(d.index()+1,c.index())),!y)return;for(o=0,p=y.length;o<p;o++)C=y[o],r=$(C).find(".col-checkbox input[type=checkbox]")[0],r&&(r.checked=!0,s=window.navigator.userAgent.indexOf("MSIE "),s?(e=document.createEvent("Event"),e.initEvent("change",!0,!0)):e=new Event("change",{bubbles:!0}),r.dispatchEvent(e))}for(_=S(a),b=[],h=0,m=_.length;h<m;h++)t=_[h],$(t).is(".col-checkbox")?b.push(i=$(t)):b.push(void 0);return b})};A();document.addEventListener("change",function(i){var a,l,d,t,e,n,s,r,o,h,c,u,f;if(e=i.target.getAttribute("data-check"),e&&(l=document.querySelectorAll("input[data-check-all-"+e+"]:checked"),u=document.querySelector(".datagrid-"+e+' select[name="group_action[group_action]"]'),a=document.querySelectorAll(".datagrid-"+e+' input[type="submit"]'),d=document.querySelector(".datagrid-"+e+" .datagrid-selected-rows-count"),l.length?(a&&a.forEach(function(p){p.disabled=!1}),u&&(u.disabled=!1),f=document.querySelectorAll("input[data-check-all-"+e+"]").length,d&&(d.innerHTML=l.length+"/"+f)):(a&&a.forEach(function(p){p.disabled=!0}),u&&(u.disabled=!0,u.value=""),d&&(d.innerHTML="")),s=window.navigator.userAgent.indexOf("MSIE "),s?(t=document.createEvent("Event"),t.initEvent("change",!0,!0)):t=new Event("change",{bubbles:!0}),u&&u.dispatchEvent(t)),e=i.target.getAttribute("data-check-all"),e){for(o=document.querySelectorAll("input[type=checkbox][data-check-all-"+e+"]"),c=[],n=0,h=o.length;n<h;n++)r=o[n],r.checked=i.target.checked,s=window.navigator.userAgent.indexOf("MSIE "),s?(t=document.createEvent("Event"),t.initEvent("change",!0,!0)):t=new Event("change",{bubbles:!0}),c.push(r.dispatchEvent(t));return c}});window.datagridSerializeUrl=function(i,a){var l=[];for(var d in i)if(i.hasOwnProperty(d)){var t=a?a+"["+d+"]":d,e=i[d];if(e!==null&&e!=="")if(typeof e=="object"){var n=window.datagridSerializeUrl(e,t);n&&l.push(n)}else l.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}return l.join("&")};N=function(){if(!(typeof $.fn.sortable>"u"))return $(".datagrid [data-sortable]").sortable({handle:".handle-sort",items:"tr",axis:"y",update:function(i,a){var l,d,t,e,n,s,r;return s=a.item.closest("tr[data-id]"),t=s.data("id"),n=null,e=null,s.prev().length&&(n=s.prev().data("id")),s.next().length&&(e=s.next().data("id")),r=$(this).data("sortable-url"),d={},l=s.closest(".datagrid").find("tbody").attr("data-sortable-parent-path"),d[(l+"-item_id").replace(/^-/,"")]=t,n!==null&&(d[(l+"-prev_id").replace(/^-/,"")]=n),e!==null&&(d[(l+"-next_id").replace(/^-/,"")]=e),x({type:"GET",url:r,data:d,error:function(o,h,c){return alert(o.statusText)}})},helper:function(i,a){return a.children().each(function(){return $(this).width($(this).width())}),a}})};$(function(){return N()});typeof P>"u"&&(P=function(){if(!(typeof $(".datagrid-tree-item-children").sortable>"u"))return $(".datagrid-tree-item-children").sortable({handle:".handle-sort",items:".datagrid-tree-item:not(.datagrid-tree-header)",toleranceElement:"> .datagrid-tree-item-content",connectWith:".datagrid-tree-item-children",update:function(i,a){var l,d,t,e,n,s,r,o,h;if($(".toggle-tree-to-delete").remove(),o=a.item.closest(".datagrid-tree-item[data-id]"),t=o.data("id"),r=null,e=null,s=null,o.prev().length&&(r=o.prev().data("id")),o.next().length&&(e=o.next().data("id")),n=o.parent().closest(".datagrid-tree-item"),n.length&&(n.find(".datagrid-tree-item-children").first().css({display:"block"}),n.addClass("has-children"),s=n.data("id")),h=$(this).data("sortable-url"),!!h)return n.find("[data-toggle-tree]").first().removeClass("hidden"),l=o.closest(".datagrid-tree").attr("data-sortable-parent-path"),d={},d[(l+"-item_id").replace(/^-/,"")]=t,r!==null&&(d[(l+"-prev_id").replace(/^-/,"")]=r),e!==null&&(d[(l+"-next_id").replace(/^-/,"")]=e),d[(l+"-parent_id").replace(/^-/,"")]=s,x({type:"GET",url:h,data:d,error:function(c,u,f){if(f!=="abort")return alert(c.statusText)}})},stop:function(i,a){return $(".toggle-tree-to-delete").removeClass("toggle-tree-to-delete")},start:function(i,a){var l;if(l=a.item.parent().closest(".datagrid-tree-item"),l.length&&l.find(".datagrid-tree-item").length===2)return l.find("[data-toggle-tree]").addClass("toggle-tree-to-delete")}})});$(function(){return P()});v("datagrid.happy",{success:function(){var i,a,l,d,t,e,n,s,r,o,h,c,u,f;for(window.happy&&window.happy.reset(),n=$(".datagrid"),f=[],s=0,c=n.length;s<c;s++){for(e=n[s],d=e.classList,l="",h=0,u=d.length;h<u;h++)i=d[h],l=l+"."+i;a=document.querySelectorAll(l+" input[data-check]:checked"),a.length===1&&a[0].getAttribute("name")==="toggle-all"?(o=document.querySelector(l+" input[name=toggle-all]"),o?(o.checked=!1,r=window.navigator.userAgent.indexOf("MSIE "),r?(t=document.createEvent("Event"),t.initEvent("change",!0,!0)):t=new Event("change",{bubbles:!0}),f.push(o.dispatchEvent(t))):f.push(void 0)):f.push(void 0)}return f}});v("datagrid.sortable",{success:function(){return N()}});v("datagrid.forms",{success:function(){return $(".datagrid").find("form").each(function(){return window.Nette.initForm(this)})}});v("datagrid.url",{success:function(i){var a,l,d,t;if(i._datagrid_url&&window.history.replaceState&&(a=window.location.protocol+"//"+window.location.host,l=window.location.pathname,d=window.datagridSerializeUrl(i.state).replace(/&+$/gm,""),d?t=a+l+"?"+d.replace(/\&*$/,""):t=a+l,t+=window.location.hash,window.location.href!==t))return window.history.replaceState({path:t},"",t)}});v("datagrid.sort",{success:function(i){var a,l,d,t;if(i._datagrid_sort){d=i._datagrid_sort,t=[];for(l in d)a=d[l],t.push($("#datagrid-sort-"+l).attr("href",a));return t}}});v("datargid.item_detail",{before:function(i,a){var l,d,t;return a.nette&&a.nette.el.attr("data-toggle-detail")?(l=a.nette.el.attr("data-toggle-detail"),t=a.nette.el.attr("data-toggle-detail-grid-fullname"),d=$(".item-detail-"+t+"-id-"+l),d.hasClass("loaded")?d.find(".item-detail-content").length?(d.hasClass("toggled")?d.find(".item-detail-content").slideToggle("fast",function(e){return function(){return d.toggleClass("toggled")}}()):(d.toggleClass("toggled"),d.find(".item-detail-content").slideToggle("fast")),!1):(d.removeClass("toggled"),!0):d.addClass("loaded")):!0},success:function(i){var a,l,d;if(i._datagrid_toggle_detail&&i._datagrid_name)return a=i._datagrid_toggle_detail,d=i._datagrid_name,l=$(".item-detail-"+d+"-id-"+a),l.toggleClass("toggled"),l.find(".item-detail-content").slideToggle("fast")}});v("datagrid.tree",{before:function(i,a){var l;return a.nette&&a.nette.el.attr("data-toggle-tree")&&(a.nette.el.toggleClass("toggle-rotate"),l=a.nette.el.closest(".datagrid-tree-item").find(".datagrid-tree-item-children").first(),l.hasClass("loaded"))?(l.slideToggle("fast"),!1):!0},success:function(i){var a,l,d,t,e,n,s;if(i._datagrid_tree){d=i._datagrid_tree,a=$('.datagrid-tree-item[data-id="'+d+'"]').find(".datagrid-tree-item-children").first(),a.addClass("loaded"),e=i.snippets;for(t in e)n=e[t],l=$(n),s=$('<div class="datagrid-tree-item" id="'+t+'">'),s.attr("data-id",l.attr("data-id")),s.append(l),l.data("has-children")&&s.addClass("has-children"),a.append(s);a.addClass("loaded"),a.slideToggle("fast"),k()}return P()}});$(document).on("click","[data-datagrid-editable-url]",function(i){var a,l,d,t,e,n,s,r,o,h,c,u;if(t=$(this),i.target.tagName.toLowerCase()!=="a"&&!t.hasClass("datagrid-inline-edit")&&!t.hasClass("editing")){t.addClass("editing"),e=t.html().trim().replace("<br>",`
`),t.attr("data-datagrid-editable-value")?u=t.data("datagrid-editable-value"):u=e,t.data("originalValue",e),t.data("valueToEdit",u),t.data("datagrid-editable-type")==="textarea"?(o=$("<textarea>"+u+"</textarea>"),r=parseInt(t.css("padding").replace(/[^-\d\.]/g,""),10),n=t.outerHeight(),h=Math.round(parseFloat(t.css("line-height"))),s=(n-2*r)/h,o.attr("rows",Math.round(s))):t.data("datagrid-editable-type")==="select"?(o=$(t.data("datagrid-editable-element")),o.find("option").each(function(){if($(this).val()===u)return o.find("option[value='"+u+"']").prop("selected",!0)})):(o=$('<input type="'+t.data("datagrid-editable-type")+'">'),o.val(u)),d=t.data("datagrid-editable-attrs");for(a in d)l=d[a],o.attr(a,l);return t.removeClass("edited"),t.html(o),c=function(f,p){var m;return m=p.val(),m!==f.data("valueToEdit")?x({url:f.data("datagrid-editable-url"),data:{value:m},type:"POST",success:function(g){return f.data("datagrid-editable-type")==="select"?f.html(o.find("option[value='"+m+"']").html()):(g._datagrid_editable_new_value&&(m=g._datagrid_editable_new_value),f.html(m)),f.addClass("edited")},error:function(){return f.html(f.data("originalValue")),f.addClass("edited-error")}}):f.html(f.data("originalValue")),setTimeout(function(){return f.removeClass("editing")},1200)},t.find("input,textarea,select").focus().on("blur",function(){return c(t,$(this))}).on("keydown",function(f){if(t.data("datagrid-editable-type")!=="textarea"&&f.which===13)return f.stopPropagation(),f.preventDefault(),c(t,$(this));if(f.which===27)return f.stopPropagation(),f.preventDefault(),t.removeClass("editing"),t.html(t.data("originalValue"))}),t.find("select").on("change",function(){return c(t,$(this))})}});v("datagrid.after_inline_edit",{success:function(i){var a=$(".datagrid-"+i._datagrid_name);if(i._datagrid_inline_edited)return a.find("tr[data-id="+i._datagrid_inline_edited+"] > td").addClass("edited"),a.find(".datagrid-inline-edit-trigger").removeClass("hidden");if(i._datagrid_inline_edit_cancel)return a.find(".datagrid-inline-edit-trigger").removeClass("hidden")}});$(document).on("mouseup","[data-datagrid-cancel-inline-add]",function(i){var a=i.which||i.keyCode||0;if(a===1)return i.stopPropagation(),i.preventDefault(),$(".datagrid-row-inline-add").addClass("datagrid-row-inline-add-hidden")});v("datagrid-toggle-inline-add",{success:function(i){var a=$(".datagrid-"+i._datagrid_name);if(i._datagrid_inline_adding){var l=a.find(".datagrid-row-inline-add");l.hasClass("datagrid-row-inline-add-hidden")&&l.removeClass("datagrid-row-inline-add-hidden"),l.find("input:not([readonly]),textarea:not([readonly])").first().focus()}}});D=function(){var i=$(".selectpicker").first();if($.fn.selectpicker)return $.fn.selectpicker.defaults={countSelectedText:i.data("i18n-selected"),iconBase:"",tickIcon:i.data("selected-icon-check")}};$(function(){return D()});T=function(){var i;if($.fn.selectpicker)return i=$("[data-datagrid-multiselect-id]"),i.each(function(){var a;if($(this).hasClass("selectpicker"))return $(this).removeAttr("id"),a=$(this).data("datagrid-multiselect-id"),$(this).on("loaded.bs.select",function(l){return $(this).parent().attr("style","display:none;"),$(this).parent().find(".hidden").removeClass("hidden").addClass("btn-default btn-secondary")}),$(this).on("rendered.bs.select",function(l){return $(this).parent().attr("id",a)})})};$(function(){return T()});v("datagrid.fitlerMultiSelect",{success:function(){if(D(),$.fn.selectpicker)return $(".selectpicker").selectpicker({iconBase:"fa"})}});v("datagrid.groupActionMultiSelect",{success:function(){return T()}});v("datagrid.inline-editing",{success:function(i){var a;if(i._datagrid_inline_editing)return a=$(".datagrid-"+i._datagrid_name),a.find(".datagrid-inline-edit-trigger").addClass("hidden")}});v("datagrid.redraw-item",{success:function(i){var a;if(i._datagrid_redraw_item_class)return a=$("tr[data-id="+i._datagrid_redraw_item_id+"]"),a.attr("class",i._datagrid_redraw_item_class)}});v("datagrid.reset-filter-by-column",{success:function(i){var a,l,d,t,e,n;if(i._datagrid_name&&(a=$(".datagrid-"+i._datagrid_name),a.find("[data-datagrid-reset-filter-by-column]").addClass("hidden"),i.non_empty_filters&&i.non_empty_filters.length)){for(n=i.non_empty_filters,d=0,e=n.length;d<e;d++)t=n[d],a.find("[data-datagrid-reset-filter-by-column="+t+"]").removeClass("hidden");return l=a.find(".reset-filter").attr("href"),a.find("[data-datagrid-reset-filter-by-column]").each(function(){var s;return t=$(this).attr("data-datagrid-reset-filter-by-column"),s=l.replace("do="+i._datagrid_name+"-resetFilter","do="+i._datagrid_name+"-resetColumnFilter"),s+="&"+i._datagrid_name+"-key="+t,$(this).attr("href",s)})}}});var I;typeof naja<"u"?I=function(i,a){var l=a.init,d=a.success,t=a.before,e=a.complete,n=function(r,o){return this.name=o,l&&r.addEventListener("init",function(h){l(h.defaultOptions)}),d&&r.addEventListener("success",function(h){d(h.response,h.options)}),t&&r.addEventListener("before",function(h){t(h.xhr,h.options)}),e&&r.addEventListener("complete",function(h){e(h.xhr,h.options)}),this};naja.registerExtension(n,i)}:$.nette&&(I=function(i,a){$.nette.ext(i,a)});I("ublaboo-spinners",{before:function(i,a){var l,d,t,e,n;if(a.nette){if(l=a.nette.el,e=$('<div class="ublaboo-spinner ublaboo-spinner-small"><i></i><i></i><i></i><i></i></div>'),l.is('.datagrid [name="group_action[submit]"]'))return l.after(e);if(l.is(".datagrid a")&&l.data("toggle-detail")){if(d=a.nette.el.attr("data-toggle-detail"),n=a.nette.el.attr("data-toggle-detail-grid-fullname"),t=$(".item-detail-"+n+"-id-"+d),!t.hasClass("loaded"))return l.addClass("ublaboo-spinner-icon")}else{if(l.is(".datagrid .col-pagination a"))return l.closest(".row-grid-bottom").find(".col-per-page").prepend(e);if(l.is(".datagrid .datagrid-per-page-submit"))return l.closest(".row-grid-bottom").find(".col-per-page").prepend(e);if(l.is(".datagrid .reset-filter"))return l.closest(".row-grid-bottom").find(".col-per-page").prepend(e)}}},complete:function(){return $(".ublaboo-spinner").remove(),$(".ublaboo-spinner-icon").removeClass("ublaboo-spinner-icon")}});var E;typeof naja<"u"?E=function(i){var a=i.type||"GET",l=i.data||null;naja.makeRequest(a,i.url,l,{history:"replace"}).then(i.success).catch(i.error)}:E=function(i){$.nette.ajax(i)};document.addEventListener("DOMContentLoaded",function(){var i=document.querySelector(".datagrid");if(i!==null)return E({type:"GET",url:i.getAttribute("data-refresh-state")})});(function(i,a,l){if(typeof a!="function")return console.error("nette.ajax.js: jQuery is missing, load it please");var d=function(){var t={self:this,initialized:!1,contexts:{},on:{init:{},load:{},prepare:{},before:{},start:{},success:{},complete:{},error:{}},fire:function(){var e=!0,n=Array.prototype.slice.call(arguments),s=n.shift(),r=typeof s=="string"?s:s.name,o=typeof s=="object"?s.off||{}:{};return n.push(t.self),a.each(t.on[r],function(h,c){if(c===l||a.inArray(h,o)!==-1)return!0;var u=c.apply(t.contexts[h],n);return e=u===l||u}),e},requestHandler:function(e){var n=t.self.ajax({},this,e);if(n&&n._returnFalse)return!1},ext:function(e,n,s){for(;!s;)s="ext_"+Math.random(),t.contexts[s]&&(s=l);a.each(e,function(r,o){t.on[r][s]=o}),t.contexts[s]=a.extend(n||{},{name:function(){return s},ext:function(r,o){var h=t.contexts[r];if(!h&&o)throw"Extension '"+this.name()+"' depends on disabled extension '"+r+"'.";return h}})}};this.ext=function(e,n,s){if(typeof e=="object")t.ext(e,n);else{if(n===l)return t.contexts[e];if(!n)a.each(["init","load","prepare","before","start","success","complete","error"],function(r,o){t.on[o][e]=l}),t.contexts[e]=l;else{if(typeof e=="string"&&t.contexts[e]!==l)throw"Cannot override already registered nette-ajax extension '"+e+"'.";t.ext(n,s,e)}}return this},this.init=function(e,n){if(t.initialized)throw"Cannot initialize nette-ajax twice.";if(typeof e=="function")this.ext("init",null),this.ext("init",{load:e},n);else if(typeof e=="object")this.ext("init",null),this.ext("init",e,n);else if(e!==l)throw"Argument of init() can be function or function-hash only.";return t.initialized=!0,t.fire("init"),this.load(),this},this.load=function(){return t.fire("load",t.requestHandler),this},this.ajax=function(e,n,s){if(a.type(e)==="string"&&(e={url:e}),!e.nette&&n&&s){var r=a(n),o,h=e.nette={e:s,ui:n,el:r,isForm:r.is("form"),isSubmit:r.is("input[type=submit]")||r.is("button[type=submit]"),isImage:r.is("input[type=image]"),form:null};if(h.isSubmit||h.isImage?h.form=h.el.closest("form"):h.isForm&&(h.form=h.el),e.url||(e.url=h.form?h.form.attr("action")||i.location.pathname+i.location.search:n.href),e.type||(e.type=h.form?h.form.attr("method"):"get"),r.is("[data-ajax-off]")){var c=r.attr("data-ajax-off");c.indexOf("[")===0?e.off=r.data("ajaxOff"):c.indexOf(",")!==-1?e.off=c.split(","):c.indexOf(" ")!==-1?e.off=c.split(" "):e.off=c,typeof e.off=="string"&&(e.off=[e.off]),e.off=a.grep(a.each(e.off,function(u){return a.trim(u)}),function(u){return u.length})}}return t.fire({name:"prepare",off:e.off||{}},e),e.prepare&&e.prepare(e),o=e.beforeSend,e.beforeSend=function(u,f){var p=t.fire({name:"before",off:f.off||{}},u,f);return(p||p===l)&&o&&(p=o(u,f)),p},this.handleXHR(a.ajax(e),e)},this.handleXHR=function(e,n){return n=n||{},e&&(typeof e.statusText>"u"||e.statusText!=="canceled")&&(e.done(function(s,r,o){t.fire({name:"success",off:n.off||{}},s,r,o,n)}).fail(function(s,r,o){t.fire({name:"error",off:n.off||{}},s,r,o,n)}).always(function(s,r){t.fire({name:"complete",off:n.off||{}},s,r,n)}),t.fire({name:"start",off:n.off||{}},e,n),n.start&&n.start(e,n)),e}};a.nette=new(a.extend(d,a.nette?a.nette:{})),a.fn.netteAjax=function(t,e){return a.nette.ajax(e||{},this[0],t)},a.fn.netteAjaxOff=function(){return this.off(".nette")},a.nette.ext("validation",{before:function(t,e){if(e.nette)var n=e.nette;else return!0;var s=n.e,r=a.extend(this.defaults,e.validate||function(){if(n.el.is("[data-ajax-validate]")){var m=n.el.data("ajaxValidate");if(m===!1)return{keys:!1,url:!1,form:!1};if(typeof m=="object")return m}}()||{}),o=!1;if(n.el.attr("data-ajax-pass")!==l&&(o=n.el.data("ajaxPass"),o=typeof o=="bool"?o:!0),r.keys){var h=s.button||s.ctrlKey||s.shiftKey||s.altKey||s.metaKey;if(n.form){if(h&&n.isSubmit)return this.explicitNoAjax=!0,!1;if(n.isForm&&this.explicitNoAjax)return this.explicitNoAjax=!1,!1}else if(h)return!1}if(r.form&&n.form){(n.isSubmit||n.isImage)&&(n.form.get(0)["nette-submittedBy"]=n.el.get(0));var c;if(typeof Nette.version>"u"||Nette.version=="2.3"){var u=this.ie();c=n.form.get(0).onsubmit&&n.form.get(0).onsubmit(typeof u<"u"&&u<9?l:s)===!1}else c=(n.form.get(0).onsubmit?n.form.triggerHandler("submit"):Nette.validateForm(n.form.get(0)))===!1;if(c)return s.stopImmediatePropagation(),s.preventDefault(),!1}if(r.url){var f=n.form?e.url:n.el.attr("href");if(/(?:^[a-z][a-z0-9+.-]*:|\/\/)/.test(f)){var p=new URL(f);if(/:|^#/.test(p.pathname+p.search+p.hash))return!1}else if(/:|^#/.test(f))return!1}return o||(s.stopPropagation(),s.preventDefault(),t._returnFalse=!0),!0}},{defaults:{keys:!0,url:!0,form:!0},explicitNoAjax:!1,ie:function(t){for(var e=3,n=document.createElement("div"),s=n.getElementsByTagName("i");n.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->",s[0];);return e>4?e:t}}),a.nette.ext("forms",{init:function(){var t;!i.Nette||!(t=this.ext("snippets"))||t.after(function(e){e.find("form").each(function(){i.Nette.initForm(this)})})},prepare:function(t){var e=t.nette;if(!(!e||!e.form)){var n=e.e,s=t.data||{},r={};if(e.isSubmit)r[e.el.attr("name")]=e.el.val()||"";else if(e.isImage){var o=e.el.offset(),h=e.el.attr("name"),c=[Math.max(0,n.pageX-o.left),Math.max(0,n.pageY-o.top)];h.indexOf("[",0)!==-1?r[h]=c:(r[h+".x"]=c[0],r[h+".y"]=c[1])}var u=e.form.attr("method");if(u&&u.toLowerCase()==="post"&&"FormData"in i){var f=new FormData(e.form[0]);for(var p in r)f.append(p,r[p]);if(typeof s!="string")for(var p in s)f.append(p,s[p]);t.data=f,t.processData=!1,t.contentType=!1}else typeof s!="string"&&(s=a.param(s)),r=a.param(r),t.data=e.form.serialize()+(r?"&"+r:"")+"&"+s}}}),a.nette.ext("snippets",{success:function(t){t.snippets&&this.updateSnippets(t.snippets)}},{beforeQueue:a.Callbacks(),afterQueue:a.Callbacks(),completeQueue:a.Callbacks(),before:function(t){this.beforeQueue.add(t)},after:function(t){this.afterQueue.add(t)},complete:function(t){this.completeQueue.add(t)},updateSnippets:function(t,e){var n=this,s=[];for(var r in t){var o=this.getElement(r);o.get(0)&&s.push(o.get(0)),this.updateSnippet(o,t[r],e)}a(s).promise().done(function(){n.completeQueue.fire()})},updateSnippet:function(t,e,n){t.is("title")?document.title=e:(this.beforeQueue.fire(t),this.applySnippet(t,e,n),this.afterQueue.fire(t))},getElement:function(t){return a("#"+this.escapeSelector(t))},applySnippet:function(t,e,n){!n&&t.is("[data-ajax-append]")?t.append(e):!n&&t.is("[data-ajax-prepend]")?t.prepend(e):(t.html()!=e||/<[^>]*script/.test(e))&&t.html(e)},escapeSelector:function(t){return t.replace(/[\!"#\$%&'\(\)\*\+,\.\/:;<=>\?@\[\\\]\^`\{\|\}~]/g,"\\$&")}}),a.nette.ext("redirect",{success:function(t){if(t.redirect)return i.location.href=t.redirect,!1}}),a.nette.ext("state",{success:function(t){t.state&&(this.state=t.state)}},{state:null}),a.nette.ext("unique",{start:function(t){this.xhr&&this.xhr.abort(),this.xhr=t},complete:function(){this.xhr=null}},{xhr:null}),a.nette.ext("abort",{init:function(){a("body").keydown(a.proxy(function(t){this.xhr&&t.keyCode.toString()==="27"&&!(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)&&this.xhr.abort()},this))},start:function(t){this.xhr=t},complete:function(){this.xhr=null}},{xhr:null}),a.nette.ext("load",{success:function(){a.nette.load()}}),a.nette.ext("init",{load:function(t){a(this.linkSelector).off("click.nette",t).on("click.nette",t),a(this.formSelector).off("submit.nette",t).on("submit.nette",t).off("click.nette",":image",t).on("click.nette",":image",t).off("click.nette",":submit",t).on("click.nette",":submit",t),a(this.buttonSelector).closest("form").off("click.nette",this.buttonSelector,t).on("click.nette",this.buttonSelector,t)}},{linkSelector:"a.ajax",formSelector:"form.ajax",buttonSelector:'input.ajax[type="submit"], button.ajax[type="submit"], input.ajax[type="image"]'})})(window,window.jQuery);(function(i){typeof define=="function"&&define.amd?define(["jquery"],i):i(jQuery)})(function(i){i.ui=i.ui||{},i.ui.version="1.12.0";var a=0,l=Array.prototype.slice;i.cleanData=function(t){return function(e){var n,s,r;for(r=0;(s=e[r])!=null;r++)try{n=i._data(s,"events"),n&&n.remove&&i(s).triggerHandler("remove")}catch{}t(e)}}(i.cleanData),i.widget=function(t,e,n){var s,r,o,h={},c=t.split(".")[0];t=t.split(".")[1];var u=c+"-"+t;return n||(n=e,e=i.Widget),i.isArray(n)&&(n=i.extend.apply(null,[{}].concat(n))),i.expr[":"][u.toLowerCase()]=function(f){return!!i.data(f,u)},i[c]=i[c]||{},s=i[c][t],r=i[c][t]=function(f,p){return this._createWidget?(arguments.length&&this._createWidget(f,p),void 0):new r(f,p)},i.extend(r,s,{version:n.version,_proto:i.extend({},n),_childConstructors:[]}),o=new e,o.options=i.widget.extend({},o.options),i.each(n,function(f,p){return i.isFunction(p)?(h[f]=function(){function m(){return e.prototype[f].apply(this,arguments)}function g(_){return e.prototype[f].apply(this,_)}return function(){var _,b=this._super,C=this._superApply;return this._super=m,this._superApply=g,_=p.apply(this,arguments),this._super=b,this._superApply=C,_}}(),void 0):(h[f]=p,void 0)}),r.prototype=i.widget.extend(o,{widgetEventPrefix:s&&o.widgetEventPrefix||t},h,{constructor:r,namespace:c,widgetName:t,widgetFullName:u}),s?(i.each(s._childConstructors,function(f,p){var m=p.prototype;i.widget(m.namespace+"."+m.widgetName,r,p._proto)}),delete s._childConstructors):e._childConstructors.push(r),i.widget.bridge(t,r),r},i.widget.extend=function(t){for(var e,n,s=l.call(arguments,1),r=0,o=s.length;o>r;r++)for(e in s[r])n=s[r][e],s[r].hasOwnProperty(e)&&n!==void 0&&(t[e]=i.isPlainObject(n)?i.isPlainObject(t[e])?i.widget.extend({},t[e],n):i.widget.extend({},n):n);return t},i.widget.bridge=function(t,e){var n=e.prototype.widgetFullName||t;i.fn[t]=function(s){var r=typeof s=="string",o=l.call(arguments,1),h=this;return r?this.each(function(){var c,u=i.data(this,n);return s==="instance"?(h=u,!1):u?i.isFunction(u[s])&&s.charAt(0)!=="_"?(c=u[s].apply(u,o),c!==u&&c!==void 0?(h=c&&c.jquery?h.pushStack(c.get()):c,!1):void 0):i.error("no such method '"+s+"' for "+t+" widget instance"):i.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+s+"'")}):(o.length&&(s=i.widget.extend.apply(null,[s].concat(o))),this.each(function(){var c=i.data(this,n);c?(c.option(s||{}),c._init&&c._init()):i.data(this,n,new e(s,this))})),h}},i.Widget=function(){},i.Widget._childConstructors=[],i.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(t,e){e=i(e||this.defaultElement||this)[0],this.element=i(e),this.uuid=a++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=i(),this.hoverable=i(),this.focusable=i(),this.classesElementLookup={},e!==this&&(i.data(e,this.widgetFullName,this),this._on(!0,this.element,{remove:function(n){n.target===e&&this.destroy()}}),this.document=i(e.style?e.ownerDocument:e.document||e),this.window=i(this.document[0].defaultView||this.document[0].parentWindow)),this.options=i.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:i.noop,_create:i.noop,_init:i.noop,destroy:function(){var t=this;this._destroy(),i.each(this.classesElementLookup,function(e,n){t._removeClass(n,e)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:i.noop,widget:function(){return this.element},option:function(t,e){var n,s,r,o=t;if(arguments.length===0)return i.widget.extend({},this.options);if(typeof t=="string")if(o={},n=t.split("."),t=n.shift(),n.length){for(s=o[t]=i.widget.extend({},this.options[t]),r=0;n.length-1>r;r++)s[n[r]]=s[n[r]]||{},s=s[n[r]];if(t=n.pop(),arguments.length===1)return s[t]===void 0?null:s[t];s[t]=e}else{if(arguments.length===1)return this.options[t]===void 0?null:this.options[t];o[t]=e}return this._setOptions(o),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return t==="classes"&&this._setOptionClasses(e),this.options[t]=e,t==="disabled"&&this._setOptionDisabled(e),this},_setOptionClasses:function(t){var e,n,s;for(e in t)s=this.classesElementLookup[e],t[e]!==this.options.classes[e]&&s&&s.length&&(n=i(s.get()),this._removeClass(s,e),n.addClass(this._classes({element:n,keys:e,classes:t,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(t){function e(r,o){var h,c;for(c=0;r.length>c;c++)h=s.classesElementLookup[r[c]]||i(),h=t.add?i(i.unique(h.get().concat(t.element.get()))):i(h.not(t.element).get()),s.classesElementLookup[r[c]]=h,n.push(r[c]),o&&t.classes[r[c]]&&n.push(t.classes[r[c]])}var n=[],s=this;return t=i.extend({element:this.element,classes:this.options.classes||{}},t),t.keys&&e(t.keys.match(/\S+/g)||[],!0),t.extra&&e(t.extra.match(/\S+/g)||[]),n.join(" ")},_removeClass:function(t,e,n){return this._toggleClass(t,e,n,!1)},_addClass:function(t,e,n){return this._toggleClass(t,e,n,!0)},_toggleClass:function(t,e,n,s){s=typeof s=="boolean"?s:n;var r=typeof t=="string"||t===null,o={extra:r?e:n,keys:r?t:e,element:r?this.element:t,add:s};return o.element.toggleClass(this._classes(o),s),this},_on:function(t,e,n){var s,r=this;typeof t!="boolean"&&(n=e,e=t,t=!1),n?(e=s=i(e),this.bindings=this.bindings.add(e)):(n=e,e=this.element,s=this.widget()),i.each(n,function(o,h){function c(){return t||r.options.disabled!==!0&&!i(this).hasClass("ui-state-disabled")?(typeof h=="string"?r[h]:h).apply(r,arguments):void 0}typeof h!="string"&&(c.guid=h.guid=h.guid||c.guid||i.guid++);var u=o.match(/^([\w:-]*)\s*(.*)$/),f=u[1]+r.eventNamespace,p=u[2];p?s.on(f,p,c):e.on(f,c)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.off(e).off(e),this.bindings=i(this.bindings.not(t).get()),this.focusable=i(this.focusable.not(t).get()),this.hoverable=i(this.hoverable.not(t).get())},_delay:function(t,e){function n(){return(typeof t=="string"?s[t]:t).apply(s,arguments)}var s=this;return setTimeout(n,e||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(e){this._addClass(i(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(i(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(e){this._addClass(i(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(i(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(t,e,n){var s,r,o=this.options[t];if(n=n||{},e=i.Event(e),e.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),e.target=this.element[0],r=e.originalEvent)for(s in r)s in e||(e[s]=r[s]);return this.element.trigger(e,n),!(i.isFunction(o)&&o.apply(this.element[0],[e].concat(n))===!1||e.isDefaultPrevented())}},i.each({show:"fadeIn",hide:"fadeOut"},function(t,e){i.Widget.prototype["_"+t]=function(n,s,r){typeof s=="string"&&(s={effect:s});var o,h=s?s===!0||typeof s=="number"?e:s.effect||e:t;s=s||{},typeof s=="number"&&(s={duration:s}),o=!i.isEmptyObject(s),s.complete=r,s.delay&&n.delay(s.delay),o&&i.effects&&i.effects.effect[h]?n[t](s):h!==t&&n[h]?n[h](s.duration,s.easing,r):n.queue(function(c){i(this)[t](),r&&r.call(n[0]),c()})}}),i.widget,i.extend(i.expr[":"],{data:i.expr.createPseudo?i.expr.createPseudo(function(t){return function(e){return!!i.data(e,t)}}):function(t,e,n){return!!i.data(t,n[3])}}),i.fn.scrollParent=function(t){var e=this.css("position"),n=e==="absolute",s=t?/(auto|scroll|hidden)/:/(auto|scroll)/,r=this.parents().filter(function(){var o=i(this);return n&&o.css("position")==="static"?!1:s.test(o.css("overflow")+o.css("overflow-y")+o.css("overflow-x"))}).eq(0);return e!=="fixed"&&r.length?r:i(this[0].ownerDocument||document)},i.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var d=!1;i(document).on("mouseup",function(){d=!1}),i.widget("ui.mouse",{version:"1.12.0",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.on("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).on("click."+this.widgetName,function(e){return i.data(e.target,t.widgetName+".preventClickEvent")===!0?(i.removeData(e.target,t.widgetName+".preventClickEvent"),e.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!d){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var e=this,n=t.which===1,s=typeof this.options.cancel=="string"&&t.target.nodeName?i(t.target).closest(this.options.cancel).length:!1;return n&&!s&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(i.data(t.target,this.widgetName+".preventClickEvent")===!0&&i.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(r){return e._mouseMove(r)},this._mouseUpDelegate=function(r){return e._mouseUp(r)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),d=!0,!0)):!0}},_mouseMove:function(t){if(this._mouseMoved){if(i.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button)return this._mouseUp(t);if(!t.which){if(t.originalEvent.altKey||t.originalEvent.ctrlKey||t.originalEvent.metaKey||t.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(t)}}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&i.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,d=!1,t.preventDefault()},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),i.widget("ui.sortable",i.ui.mouse,{version:"1.12.0",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,n){return t>=e&&e+n>t},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),t==="handle"&&this._setHandleClassName()},_setHandleClassName:function(){var t=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),i.each(this.items,function(){t._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,e){var n=null,s=!1,r=this;return this.reverting||this.options.disabled||this.options.type==="static"?!1:(this._refreshItems(t),i(t.target).parents().each(function(){return i.data(this,r.widgetName+"-item")===r?(n=i(this),!1):void 0}),i.data(t.target,r.widgetName+"-item")===r&&(n=i(t.target)),n&&(!this.options.handle||e||(i(this.options.handle,n).find("*").addBack().each(function(){this===t.target&&(s=!0)}),s))?(this.currentItem=n,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(t,e,n){var s,r,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},i.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&o.cursor!=="auto"&&(r=this.document.find("body"),this.storedCursor=r.css("cursor"),r.css("cursor",o.cursor),this.storedStylesheet=i("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(r)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(s=this.containers.length-1;s>=0;s--)this.containers[s]._trigger("activate",t,this._uiHash(this));return i.ui.ddmanager&&(i.ui.ddmanager.current=this),i.ui.ddmanager&&!o.dropBehaviour&&i.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var e,n,s,r,o=this.options,h=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-this.document.scrollTop()<o.scrollSensitivity?h=this.document.scrollTop(this.document.scrollTop()-o.scrollSpeed):this.window.height()-(t.pageY-this.document.scrollTop())<o.scrollSensitivity&&(h=this.document.scrollTop(this.document.scrollTop()+o.scrollSpeed)),t.pageX-this.document.scrollLeft()<o.scrollSensitivity?h=this.document.scrollLeft(this.document.scrollLeft()-o.scrollSpeed):this.window.width()-(t.pageX-this.document.scrollLeft())<o.scrollSensitivity&&(h=this.document.scrollLeft(this.document.scrollLeft()+o.scrollSpeed))),h!==!1&&i.ui.ddmanager&&!o.dropBehaviour&&i.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&this.options.axis==="y"||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&this.options.axis==="x"||(this.helper[0].style.top=this.position.top+"px"),e=this.items.length-1;e>=0;e--)if(n=this.items[e],s=n.item[0],r=this._intersectsWithPointer(n),r&&n.instance===this.currentContainer&&s!==this.currentItem[0]&&this.placeholder[r===1?"next":"prev"]()[0]!==s&&!i.contains(this.placeholder[0],s)&&(this.options.type==="semi-dynamic"?!i.contains(this.element[0],s):!0)){if(this.direction=r===1?"down":"up",this.options.tolerance!=="pointer"&&!this._intersectsWithSides(n))break;this._rearrange(t,n),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),i.ui.ddmanager&&i.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,e){if(t){if(i.ui.ddmanager&&!this.options.dropBehaviour&&i.ui.ddmanager.drop(this,t),this.options.revert){var n=this,s=this.placeholder.offset(),r=this.options.axis,o={};r&&r!=="x"||(o.left=s.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),r&&r!=="y"||(o.top=s.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,i(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){n._clear(t)})}else this._clear(t,e);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),this.options.helper==="original"?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),i.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?i(this.domPosition.prev).after(this.currentItem):i(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var e=this._getItemsAsjQuery(t&&t.connected),n=[];return t=t||{},i(e).each(function(){var s=(i(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);s&&n.push((t.key||s[1]+"[]")+"="+(t.key&&t.expression?s[1]:s[2]))}),!n.length&&t.key&&n.push(t.key+"="),n.join("&")},toArray:function(t){var e=this._getItemsAsjQuery(t&&t.connected),n=[];return t=t||{},e.each(function(){n.push(i(t.item||this).attr(t.attribute||"id")||"")}),n},_intersectsWith:function(t){var e=this.positionAbs.left,n=e+this.helperProportions.width,s=this.positionAbs.top,r=s+this.helperProportions.height,o=t.left,h=o+t.width,c=t.top,u=c+t.height,f=this.offset.click.top,p=this.offset.click.left,m=this.options.axis==="x"||s+f>c&&u>s+f,g=this.options.axis==="y"||e+p>o&&h>e+p,_=m&&g;return this.options.tolerance==="pointer"||this.options.forcePointerForContainers||this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?_:e+this.helperProportions.width/2>o&&h>n-this.helperProportions.width/2&&s+this.helperProportions.height/2>c&&u>r-this.helperProportions.height/2},_intersectsWithPointer:function(t){var e,n,s=this.options.axis==="x"||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),r=this.options.axis==="y"||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),o=s&&r;return o?(e=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection(),this.floating?n==="right"||e==="down"?2:1:e&&(e==="down"?2:1)):!1},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),n=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),s=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return this.floating&&r?r==="right"&&n||r==="left"&&!n:s&&(s==="down"&&e||s==="up"&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return t!==0&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return t!==0&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(t){function e(){h.push(this)}var n,s,r,o,h=[],c=[],u=this._connectWith();if(u&&t)for(n=u.length-1;n>=0;n--)for(r=i(u[n],this.document[0]),s=r.length-1;s>=0;s--)o=i.data(r[s],this.widgetFullName),o&&o!==this&&!o.options.disabled&&c.push([i.isFunction(o.options.items)?o.options.items.call(o.element):i(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(c.push([i.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):i(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=c.length-1;n>=0;n--)c[n][0].each(e);return i(h)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=i.grep(this.items,function(e){for(var n=0;t.length>n;n++)if(t[n]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var e,n,s,r,o,h,c,u,f=this.items,p=[[i.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):i(this.options.items,this.element),this]],m=this._connectWith();if(m&&this.ready)for(e=m.length-1;e>=0;e--)for(s=i(m[e],this.document[0]),n=s.length-1;n>=0;n--)r=i.data(s[n],this.widgetFullName),r&&r!==this&&!r.options.disabled&&(p.push([i.isFunction(r.options.items)?r.options.items.call(r.element[0],t,{item:this.currentItem}):i(r.options.items,r.element),r]),this.containers.push(r));for(e=p.length-1;e>=0;e--)for(o=p[e][1],h=p[e][0],n=0,u=h.length;u>n;n++)c=i(h[n]),c.data(this.widgetName+"-item",o),f.push({item:c,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.floating=this.items.length?this.options.axis==="x"||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var e,n,s,r;for(e=this.items.length-1;e>=0;e--)n=this.items[e],n.instance!==this.currentContainer&&this.currentContainer&&n.item[0]!==this.currentItem[0]||(s=this.options.toleranceElement?i(this.options.toleranceElement,n.item):n.item,t||(n.width=s.outerWidth(),n.height=s.outerHeight()),r=s.offset(),n.left=r.left,n.top=r.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(e=this.containers.length-1;e>=0;e--)r=this.containers[e].element.offset(),this.containers[e].containerCache.left=r.left,this.containers[e].containerCache.top=r.top,this.containers[e].containerCache.width=this.containers[e].element.outerWidth(),this.containers[e].containerCache.height=this.containers[e].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var e,n=t.options;n.placeholder&&n.placeholder.constructor!==String||(e=n.placeholder,n.placeholder={element:function(){var s=t.currentItem[0].nodeName.toLowerCase(),r=i("<"+s+">",t.document[0]);return t._addClass(r,"ui-sortable-placeholder",e||t.currentItem[0].className)._removeClass(r,"ui-sortable-helper"),s==="tbody"?t._createTrPlaceholder(t.currentItem.find("tr").eq(0),i("<tr>",t.document[0]).appendTo(r)):s==="tr"?t._createTrPlaceholder(t.currentItem,r):s==="img"&&r.attr("src",t.currentItem.attr("src")),e||r.css("visibility","hidden"),r},update:function(s,r){(!e||n.forcePlaceholderSize)&&(r.height()||r.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),r.width()||r.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=i(n.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),n.placeholder.update(t,t.placeholder)},_createTrPlaceholder:function(t,e){var n=this;t.children().each(function(){i("<td>&#160;</td>",n.document[0]).attr("colspan",i(this).attr("colspan")||1).appendTo(e)})},_contactContainers:function(t){var e,n,s,r,o,h,c,u,f,p,m=null,g=null;for(e=this.containers.length-1;e>=0;e--)if(!i.contains(this.currentItem[0],this.containers[e].element[0]))if(this._intersectsWith(this.containers[e].containerCache)){if(m&&i.contains(this.containers[e].element[0],m.element[0]))continue;m=this.containers[e],g=e}else this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",t,this._uiHash(this)),this.containers[e].containerCache.over=0);if(m)if(this.containers.length===1)this.containers[g].containerCache.over||(this.containers[g]._trigger("over",t,this._uiHash(this)),this.containers[g].containerCache.over=1);else{for(s=1e4,r=null,f=m.floating||this._isFloating(this.currentItem),o=f?"left":"top",h=f?"width":"height",p=f?"pageX":"pageY",n=this.items.length-1;n>=0;n--)i.contains(this.containers[g].element[0],this.items[n].item[0])&&this.items[n].item[0]!==this.currentItem[0]&&(c=this.items[n].item.offset()[o],u=!1,t[p]-c>this.items[n][h]/2&&(u=!0),s>Math.abs(t[p]-c)&&(s=Math.abs(t[p]-c),r=this.items[n],this.direction=u?"up":"down"));if(!r&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[g])return this.currentContainer.containerCache.over||(this.containers[g]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1),void 0;r?this._rearrange(t,r,null,!0):this._rearrange(t,null,this.containers[g].element,!0),this._trigger("change",t,this._uiHash()),this.containers[g]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[g],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[g]._trigger("over",t,this._uiHash(this)),this.containers[g].containerCache.over=1}},_createHelper:function(t){var e=this.options,n=i.isFunction(e.helper)?i(e.helper.apply(this.element[0],[t,this.currentItem])):e.helper==="clone"?this.currentItem.clone():this.currentItem;return n.parents("body").length||i(e.appendTo!=="parent"?e.appendTo:this.currentItem[0].parentNode)[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!n[0].style.width||e.forceHelperSize)&&n.width(this.currentItem.width()),(!n[0].style.height||e.forceHelperSize)&&n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" ")),i.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return this.cssPosition==="absolute"&&this.scrollParent[0]!==this.document[0]&&i.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&i.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,e,n,s=this.options;s.containment==="parent"&&(s.containment=this.helper[0].parentNode),(s.containment==="document"||s.containment==="window")&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,s.containment==="document"?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,(s.containment==="document"?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(s.containment)||(t=i(s.containment)[0],e=i(s.containment).offset(),n=i(t).css("overflow")!=="hidden",this.containment=[e.left+(parseInt(i(t).css("borderLeftWidth"),10)||0)+(parseInt(i(t).css("paddingLeft"),10)||0)-this.margins.left,e.top+(parseInt(i(t).css("borderTopWidth"),10)||0)+(parseInt(i(t).css("paddingTop"),10)||0)-this.margins.top,e.left+(n?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(i(t).css("borderLeftWidth"),10)||0)-(parseInt(i(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,e.top+(n?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(i(t).css("borderTopWidth"),10)||0)-(parseInt(i(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,e){e||(e=this.position);var n=t==="absolute"?1:-1,s=this.cssPosition!=="absolute"||this.scrollParent[0]!==this.document[0]&&i.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,r=/(html|body)/i.test(s[0].tagName);return{top:e.top+this.offset.relative.top*n+this.offset.parent.top*n-(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():r?0:s.scrollTop())*n,left:e.left+this.offset.relative.left*n+this.offset.parent.left*n-(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():r?0:s.scrollLeft())*n}},_generatePosition:function(t){var e,n,s=this.options,r=t.pageX,o=t.pageY,h=this.cssPosition!=="absolute"||this.scrollParent[0]!==this.document[0]&&i.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,c=/(html|body)/i.test(h[0].tagName);return this.cssPosition!=="relative"||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(r=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(r=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),s.grid&&(e=this.originalPageY+Math.round((o-this.originalPageY)/s.grid[1])*s.grid[1],o=this.containment?e-this.offset.click.top>=this.containment[1]&&e-this.offset.click.top<=this.containment[3]?e:e-this.offset.click.top>=this.containment[1]?e-s.grid[1]:e+s.grid[1]:e,n=this.originalPageX+Math.round((r-this.originalPageX)/s.grid[0])*s.grid[0],r=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-s.grid[0]:n+s.grid[0]:n)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():c?0:h.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():c?0:h.scrollLeft())}},_rearrange:function(t,e,n,s){n?n[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],this.direction==="down"?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var r=this.counter;this._delay(function(){r===this.counter&&this.refreshPositions(!s)})},_clear:function(t,e){function n(o,h,c){return function(u){c._trigger(o,u,h._uiHash(h))}}this.reverting=!1;var s,r=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)(this._storedCSS[s]==="auto"||this._storedCSS[s]==="static")&&(this._storedCSS[s]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&r.push(function(o){this._trigger("receive",o,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||r.push(function(o){this._trigger("update",o,this._uiHash())}),this!==this.currentContainer&&(e||(r.push(function(o){this._trigger("remove",o,this._uiHash())}),r.push(function(o){return function(h){o._trigger("receive",h,this._uiHash(this))}}.call(this,this.currentContainer)),r.push(function(o){return function(h){o._trigger("update",h,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)e||r.push(n("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(r.push(n("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(s=0;r.length>s;s++)r[s].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){i.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var e=t||this;return{helper:e.helper,placeholder:e.placeholder||i([]),position:e.position,originalPosition:e.originalPosition,offset:e.positionAbs,item:e.currentItem,sender:t?t.element:null}}})});
